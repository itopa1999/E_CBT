{% extends 'main.html' %}
{% load static %}

{% block content %}
<style>

</style>
 
  <div class="pagetitle">
    <div>
      <h1>Dashboard</h1>
        <i data-bs-toggle="modal" data-bs-target="#viewResult"  style="float: right; color:#2f589e; font-size: 50px; cursor: pointer;" class="bi bi-gear-fill m-3" title="Settings"></i> 
        <a href="{% url 't_c' %}"><i style="float: right; color:#2f589e; font-size: 50px; cursor: pointer;" class="bi bi-patch-exclamation-fill m-3" title="ReadMe"></i></a>
    </div>
    
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'admin_dashboard' %}">Dashboard</a></li>
        <li class="breadcrumb-item"></li>
      </ol>
    </nav>
  </div><!-- End Page Title -->
  <br><br><br>
  <section class="section">
    <div class="container-fluid">
        <section id="why-us" class="why-us">
            <div class="container">
        
              <div class="row">
        
                <div class="col-lg-4">
                  <a href="{% url 'all-student' %}">
                  <div class="box">
                    <span><i class="bi bi-people-fill" style="font-size:50px;"></i></span>
                    <h4>Total Student</h4>
                    <p style="font-size:50px; font-weight: bolder;">{{total_student}}</p>
                  </div>
                </a>
                </div>
        
                <div class="col-lg-4 mt-4 mt-lg-0">
                  <a href="{% url 'course' %}">
                  <div class="box">
                    <span><i class="bi bi-journal-text" style="font-size:50px;"></i></span>
                    <h4> Total Course</h4>
                    <p style="font-size:50px; font-weight: bolder;">{{total_course}}</p>
                  </div>
                </a>
                </div>
        
                <div class="col-lg-4 mt-4 mt-lg-0">
                  <a href="{% url 'department' %}">
                  <div class="box">
                    <span><i class="bi bi-bank2" style="font-size:50px;"></i></span>
                    <h4>Total Department</h4>
                    <p style="font-size:50px; font-weight: bolder;">{{total_department}}</p>
                  </div>
                  </a>
                </div>
              </div>
              <br><br>
              <div class="row">
        
                <div class="col-lg-4">
                  <div class="box">
                    <span><i class="bi bi-person-check-fill" style="font-size:50px;"></i></span>
                    <h4>Total Logged In Students</h4>
                    <p style="font-size:50px; font-weight: bolder;" id="login-data">loading...</p>
                  </div>
                </div>

                <div class="col-lg-4">
                  <a href="{% url 'exammode' %}">
                  <div class="box">
                    <span><i class="bi bi-person-bounding-box" style="font-size:50px;"></i></span>
                    <h4>Total Students in Exam Mode</h4>
                    <p style="font-size:50px; font-weight: bolder;" id="mode-data">loading..</p>
                  </div>
                  </a>
                </div>
        
                <div class="col-lg-4 mt-4 mt-lg-0">
                  <a href="{% url 'submitmode' %}">
                  <div class="box">
                    <span><i class="bi bi-person-check" style="font-size:50px;"></i></span>
                    <h4>Total Students Submitted</h4>
                    <p style="font-size:50px; font-weight: bolder;" id="submit-data">loading..</p>
                  </div>
                  </a>
                </div>
              </div>
                

              <br><br>
              <div class="row">
                <div class="col-lg-4 mt-4 mt-lg-0">
                  <div class="box">
                    <span><i class="bi bi-person-badge" style="font-size:50px;"></i></span>
                    <h4> Total Students Till Writing</h4>
                    <p style="font-size:50px; font-weight: bolder;" id="remain-data">loading..</p>
                  </div>
                </div>
              </div>
              </div>
        
            
          </section>



    </div>
  </section>


  <div class="modal fade" id="viewResult" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Settings Control</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="clearfix">
            {% if exam %}
            <span class="float-start">Exam Permission ON</span>
            <a href="{% url 'exam_per_off' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-on" style="color:#2f589e; font-size: 30px; "></i></span></a>
            {% else %}
            <span class="float-start">Exam Permission OFF</span>
            <a href="{% url 'exam_per_on' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-off" style="color:#2f589e; font-size: 30px; "></i></span></a>
            {% endif %}
          </div>
          <hr>
          <div class="clearfix">
            
            {% if exam_submit %}
            <span class="float-start">Exam Submit Control ON</span>
            <a href="{% url 'exam_submit_off' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-on" style="color:#2f589e; font-size: 30px; "></i></span></a>
            {% else %}
            <span class="float-start">Exam Submit Control OFF</span>
            <a href="{% url 'exam_submit_on' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-off" style="color:#2f589e; font-size: 30px; "></i></span></a>
            {% endif %}
          </div>
          <hr>
          <div class="clearfix">
            
            {% if student_permission %}
            <span class="float-start">Student Permission ON</span>
            <a href="{% url 'student_permission_off' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-on" style="color:#2f589e; font-size: 30px; "></i></span></a>
            {% else %}
            <span class="float-start">Student Permission OFF</span>
            <a href="{% url 'student_permission_on' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-off" style="color:#2f589e; font-size: 30px; "></i></span></a>
            {% endif %}
          </div>
        <hr>
        <div class="clearfix">
          
          {% if cou.view_result == True %}
          <span class="float-start">Result Permission ON</span>
          <a href="{% url 'view_result_off' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-on" style="color:#2f589e; font-size: 30px; "></i></span></a>
          {% else %}
          <span class="float-start">Result Permission OFF</span>
          <a href="{% url 'view_result_on' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-off" style="color:#2f589e; font-size: 30px; "></i></span></a>
          {% endif %}
      </div>
        <hr>
        <div class="clearfix">
          
          {% if cou.stop_time == True %}
          <span class="float-start">Stop Time ON</span>
          <a href="{% url 'soon' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-on" style="color:#2f589e; font-size: 30px; "></i></span></a>
          {% else %}
          <span class="float-start">Stop Time OFF</span>
          <a href="{% url 'soon' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-off" style="color:#2f589e; font-size: 30px; "></i></span></a>
          {% endif %}
        </div>
        <hr>

{% comment %}
   {% if cou.stop_time == True %}
          <span class="float-start">Stop Time ON</span>
          <a href="{% url 'stop_time_off' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-on" style="color:#2f589e; font-size: 30px; "></i></span></a>
          {% else %}
          <span class="float-start">Stop Time OFF</span>
          <a href="{% url 'stop_time_on' %}?next={{ request.GET.next }}"><span class="float-end"><i class="bi bi-toggle-off" style="color:#2f589e; font-size: 30px; "></i></span></a>
          {% endif %}
{% endcomment %}
  
      </div>
    </div>
  </div>

  <script>
    function loadData() {
            fetch('count_mode/')
            .then(response => response.json())
            .then(data => {
                document.getElementById('mode-data').innerHTML = `${data.mode}`;
                document.getElementById('submit-data').innerHTML = `${data.submit}`;
                document.getElementById('remain-data').innerHTML = `${data.remain}`;
                document.getElementById('login-data').innerHTML = `${data.login}`;
            })
            .catch(error => {
                // Handle errors
                console.error('Error fetching admin dashboard data:', error);
            });
    }

    // Load data every 2 seconds
    setInterval(loadData, 2000);

    // Initial load when the page is first loaded
    loadData();
</script>
{% endblock content %}



